# Spring Countdown - Cloudflare Worker Configuration
name = "spring-countdown"
main = "src/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# Custom domains (auto-configures DNS)
routes = [
  { pattern = "springcountdown.com", custom_domain = true },
  { pattern = "www.springcountdown.com", custom_domain = true }
]

# Development settings
[dev]
port = 8787
local_protocol = "http"

# Environment variables (non-sensitive)
[vars]
ENVIRONMENT = "production"
SPRING_EQUINOX = "2026-03-20T10:46:00Z"  # UTC time for spring equinox 2026
DST_START = "2026-03-08T07:00:00Z"        # 2AM EST = 7AM UTC (March 8, 2026)

# D1 Database - User preferences and location data
[[d1_databases]]
binding = "DB"
database_name = "spring-db"
database_id = "887b912a-7836-41c6-a750-d81c5dd95851"

# KV Namespace - Caching sunrise/sunset data
[[kv_namespaces]]
binding = "KV"
id = "176c276770b545ee8d3cf71b4bb74dad"

# R2 Bucket - Generated share images
[[r2_buckets]]
binding = "STORAGE"
bucket_name = "spring-images"

# Workers AI binding
[ai]
binding = "AI"

# Assets (static files)
[assets]
directory = "./public"

# Staging environment
[env.staging]
name = "spring-countdown-staging"
vars = { ENVIRONMENT = "staging" }

# Preview environment (for PR deploys)
[env.preview]
name = "spring-countdown-preview"
vars = { ENVIRONMENT = "preview" }
